import requests
import json
import hashlib

# Get hash file
def hash_md5(file_path):
    md5_hash = hashlib.md5()
    with open(file_path, "rb") as file:
        # Read and update hash string value in blocks of 4K
        for chunk in iter(lambda: file.read(4096), b""):
            md5_hash.update(chunk)
    return md5_hash.hexdigest()

#Get file info
def get_file_info(file_id, api_key):
    url = f"https://www.virustotal.com/api/v3/files/{file_id}"
    headers = {
        'x-apikey': api_key,
    }

    response = requests.get(url, headers=headers)

    if response.status_code == 200:
        file_info = response.json()
        return file_info
    else:
        print(f"Failed to fetch information. Status code: {response.status_code}")
        return None
